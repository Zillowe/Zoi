name: "Zoi"
packages:
  - name: "rustc"
    check: "rustc --version"
  - name: "cargo"
    check: "cargo --version"

commands:
  - cmd: "build"
    run: "./build/build-release.sh"
  - cmd: "lines"
    run: "cloc src build.rs"
  - cmd: "install"
    run: "cargo clean && ./configure && make && sudo make install && make install-completions"
  - cmd: "deps"
    run: "cargo machete"
  - cmd: "fmt"
    run: "cargo fmt --all"
  - cmd: "lint"
    run: "cargo clippy --all-targets --fix --allow-dirty --allow-staged"
  - cmd: "check"
    run: "cargo check"

environments:
  - name: "Prepare"
    cmd: "pre"
    run: ["zoi run deps", "zoi run lint", "zoi run fmt", "zoi run check"]
